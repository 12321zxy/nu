(function(){"use strict";var a,b;a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=function(){var b;for(b="";b.length<5;)b+=a[Math.floor(Math.random()*a.length)];return b},angular.module("conta",["commonWeb","envConfig","ipCookie","mm.foundation","ngAnimate","ngMaterial","ngCookies","ngRoute","ngTagsInput","ng.picturefill","oc.lazyLoad","ui.utils.masks"]).config(["$routeProvider","$httpProvider","CONFIG",function(a,c,d){return a.when("/invitation",{controller:function(){return window.location.replace("/referral.html"+window.location.hash.replace("#/invitation",""))},template:"<div></div>"}).when("/login",{templateUrl:"components/login/login.template.html",title:"Login - Nubank"}).when("/account-recovery",{templateUrl:"components/account-recovery/account-recovery.template.html",controller:"AccountRecoveryCtrl",title:"Recuperação de Conta - Nubank"}).when("/account-recovery/confirmed",{templateUrl:"components/account-recovery/email-changed.template.html",title:"Recuperação de Conta - Nubank"}).when("/account-recovery/expired",{templateUrl:"components/account-recovery/link-expired.template.html",title:"Recuperação de Conta - Nubank"}).when("/account-recovery/error",{templateUrl:"components/account-recovery/error.template.html",title:"Recuperação de Conta - Nubank"}).when("/profile",{templateUrl:"components/profile/profile.template.html",controller:"ProfileCtrl",title:"Meus dados - Nubank"}).when("/bills",{templateUrl:"components/bills/bills.template.html",controller:"BillsCtrl",title:"Faturas - Nubank"}).when("/transactions",{templateUrl:"components/transactions/transactions.template.html",controller:"TransactionsCtrl",title:"Histórico - Nubank"}).otherwise({redirectTo:"/login"}),c.defaults.useXDomain=!0,c.interceptors.push(["$q","$rootScope","ipCookie","$location",function(a,c,e,f){var g;return g=0,{request:function(e){return g++,c.$broadcast("loader_show"),e&&(e.headers=e.headers||{},e.headers["X-Correlation-Id"]=d.appName+"."+b()),e||a.when(e)},response:function(b){return 0===--g&&c.$broadcast("loader_hide"),b||a.when(b)},responseError:function(b){return"/invitation"!==f.$$path&&"401"===b.status&&(delete window.sessionStorage.user,e.remove("user",{domain:".nubank.com.br"}),window.location="#/login"),--g||c.$broadcast("loader_hide"),a.reject(b)}}}]),moment.locale("pt-br",{months:"janeiro_fevereiro_março_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_")})}]).run(["$rootScope","$location","ipCookie","$timeout","i18n","auth","Account","Customer","CONFIG","$route","_",function(a,b,c,d,e,f,g,h,i,j,k){a.appName="Nubank",a.gaMGM=i.tokens.ga_mgm,a.lang=function(a){return a?e.set_lang(a):c("lang")},a.t=e.app(),a.links=i.bookmarks,a.account={},a.customer={},a.cardStatus="",a.x=k.isString(c("customerId"))&&"root"===c("user"),a.x?f.impersonate():f.restoreOrFetchLinks(),e.set_lang(c("lang")||"pt"),"/invitation"!==b.$$path&&"/account-recovery"!==b.$$path&&f.enforce({preventDefault:function(){}},null,"login"),a.$on("$viewContentLoaded",function(){return d(function(){return $(document).foundation()},1500)}),amplitude.init(i.tokens.amplitude),amplitude.setUserProperties({Client:"conta"}),a.$on("$routeChangeSuccess",function(b,c){var d;return d=c.$$route?c.$$route.title:"Nubank",a.$broadcast("updatePageTitle",d),window.scrollTo(0,0)})}])}).call(this),function(){"use strict";var a;a=function(a,b){return{restrict:"E",template:['<span class="card-block-notice" ng-if="cardStatus === \'inactive\'">Acesse sua conta pelo app para desbloquear o cartão</span>','<span class="locker" ng-class="cardStatus" ng-click="cardLocker()" ng-if="cardStatus !== \'inactive\'">{{ lockerLabel }}</span>','<span class="card-block-error" style="display: none;">Houve um erro, por favor, tente novamente.</span>'].join(""),link:function(c,d){b.$watch("cardStatus",function(a){if(a)return c.cardStatus=a,c.lockerLabel="active"===a?"bloquear cartão":"desbloquear cartão"}),b.$on("cardBlokingError",function(a){return $(".card-block-error").show()}),c.cardLocker=function(){return $(".card-block-error").hide(),"active"===c.cardStatus?a.block():a.unblock()}}}},angular.module("conta").directive("cardBlock",["Card","$rootScope",a])}.call(this),function(){"use strict";var a;a=function(b,c,d){return d.$on("authenticated",function(){return a.fetch()}),a={get:function(){return d.customer},set:function(a){return d.customer=a},fetch:function(){return c.get(b.getLink("customer")).error(function(a,b){return console.warn("Could not get customer",a,b)}).success(function(b){return a.set(b.customer),d.$broadcast("customerReady")})}}},angular.module("conta").factory("Customer",["auth","$http","$rootScope",a])}.call(this),function(){"use strict";var a;a=function(b,c,d){return d.$on("customerReady",function(){return a.fetch()}),a={get:function(){return d.account},set:function(a){return d.account=a},fetch:function(){return c.get(b.getLink("account")).error(function(a,b){return console.warn("Could not get account",a,b),d.$broadcast("accountFailed")}).success(function(b){return a.set(b.account),d.$broadcast("accountReady")})}}},angular.module("conta").factory("Account",["auth","$http","$rootScope",a])}.call(this),function(){"use strict";var a;a=function(b,c){return c.$on("clearData",function(){return a.setStatus(null)}),c.$on("accountReady",function(){return a.setStatus(c.account.cards[0].status)}),a={setStatus:function(a){c.cardStatus=a,c.$broadcast("cardStatusUpdated")},fetch:function(){if(!c.x)return b.get(c.account.cards[0]._links.self.href).error(function(){return console.warn("Could not fetch card status")}).success(function(b){return a.setStatus(b.card.status)})},block:function(){return b.put(c.account.cards[0]._links.block.href,{}).error(function(a){return c.$broadcast("cardBlokingError",a)}).success(function(b){return a.setStatus(b.card.status),amplitude.logEvent("Card: Block")})},unblock:function(){return b.put(c.account.cards[0]._links.unblock.href,{}).error(function(a){return c.$broadcast("cardBlokingError",a)}).success(function(b){return a.setStatus(b.card.status),amplitude.logEvent("Card: Unblock")})}}},angular.module("conta").factory("Card",["$http","$rootScope",a])}.call(this),function(){"use strict";var a;a=function(b,c,d,e,f,g,h){var i,j,k;return k=function(b){return b||(b=a.all),h.map(b,function(a){return a.dd=d3.time.format("%d/%b/%Y")(new Date(Date.parse(a.time))),a.week=d3.time.week(new Date(Date.parse(a.time))),a.description=h.escape(a.description),a.title=h.escape(a.title),null!=a.details&&null!=a.details.tags&&(a.details.tags=h.map(a.details.tags,h.escape)),"transaction"!==a.category||"transaction_reversed"===a.category?a.crossfilter_amount=0:a.crossfilter_amount=a.amount,a})},j=function(){return a.last=null,a.all=null,a.updateURL=null,a.categories=null,a.needUpdate=!0},i=function(a){var b;return b=h.find(a,function(a){return"transaction"===a.category})},d.$on("clearData",function(){return j()}),d.$on("accountReady",function(){if(null!==f.account)return a.getTransactions()}),a={last:null,all:null,updateURL:null,categories:null,needUpdate:!0,getTransactions:function(b){return a.updateURL?a.updateTransactions().then(function(b){return b.data.events.forEach(function(b){var c;c=a.all.indexOf(h.find(a.all,function(a){return a.id===b.id})),a.all.splice(c,1),a.all.push(b)}),k(a.all)}):null===a.all?a.loadTransactions().then(function(b){return a.all=k(b.data.events),a.updateURL=b.data._links.updates.href,a.currentPage=1,a.needUpdate=!1,d.$broadcast("transactionsReady"),a.all}):c(function(b){return b(a.all)})},loadTransactions:function(){return b.get(g.getLink("events"))},updateTransactions:function(){return b.get(a.updateURL)},setLast:function(b){return a.last=b,d.$broadcast("lastTransactionReady")},getCategories:function(d){return null===a.categories?b.get(d.data.transaction._links.categories.href).then(function(b){return a.setCategories(b.data),a.categories}):c(function(b){return b(a.categories)})},setCategories:function(b){return a.categories=h.sortBy(b,function(a){return a})},getDetails:function(a){return b.get(a)},removeTag:function(a){return b.delete(a._links.remove.href)},addTag:function(a,c){return b.post(a.create_tag.href,c)},setCategory:function(a,c){return b.patch(a.category.href,{mcc:c})},setMerchantName:function(a,c){return b.patch(a.merchant.href,{name:c})},removeLocation:function(a){return b.delete(a.notify_geo.href)},openDetails:function(b){var c,f;return c=b,f=e.open({templateUrl:"components/transactions/tx-editor.template.html",controller:"transactionEditor",resolve:{transactionData:function(){return a.getDetails(c.attributes["data-link"].value).then(function(b){return a.getCategories(b).then(function(){return b})})}}}),f.result.catch(function(){return d.$broadcast("reloadTransactionsPanel")})}}},angular.module("conta").factory("Transactions",["$http","$q","$rootScope","$modal","Account","auth","_",a])}.call(this),function(){"use strict";var a;a=function(b,c,d,e){return d.$on("clearData",function(){return a.all=null,a.needUpdate=!1}),a={all:null,currentBill:null,_links:null,needUpdate:!1,getSummary:function(){return null===a.all||a.needUpdate?b.get(d.account._links.bills_summary.href).then(function(b){var c,d,e,f;for(a.all=b.data.bills,a._links=b.data._links,f=a.all,d=0,e=f.length;d<e;d++)c=f[d],c.loaded=!1;return a.all}):c(function(b){return b(a.all)})},fetchBill:function(a){return b.get(a._links.self.href).then(function(b){return a.more=b.data.bill,a.loaded=!0,"closed"===a.state&&d.$broadcast("firstBillLoaded"),a},function(b){return a.more=-1,a.loaded=!0,d.$broadcast("firstBillLoaded"),a})},fetchOpenBill:function(c){return b.get(a._links.open.href).then(function(a){return c.more=a.data.bill,c.loaded=!0,d.$broadcast("firstBillLoaded"),c},function(a){return c.more=-1,c.loaded=!0,d.$broadcast("firstBillLoaded"),c})},fetchFutureBill:function(){return b.get(a._links.future.href).then(function(a){return a})},loadBills:function(){var b,c,d,f,g,h,i;for(c=e.find(a.all,function(a){return"closed"===a.state}),h=e.find(a.all,function(a){return"open"===a.state}),i=e.filter(a.all,function(a){return"overdue"===a.state}),d=e.filter(a.all,function(a){return"future"===a.state}),c&&a.fetchBill(c),h&&a.fetchOpenBill(h),d&&a.fetchFutureBill().then(function(a){var b,c,f;for(c=0,f=d.length;c<f;c++)b=d[c],b.more=e.find(a.data.bills,function(a){return a.summary.due_date===b.summary.due_date}),b.loaded=!0;return a}),f=0,g=i.length;f<g;f++)b=i[f],a.fetchBill(b)},requestBoletoEmail:function(a,c){return b.post(a.more._links.boleto_email.href,{amount:c})},getBarcode:function(a){return b.get(a.more._links.barcode.href)},requestInvoice:function(a){return b.post(a,{})},reset:function(){return a.all=null}}},angular.module("conta").factory("Bills",["$http","$q","$rootScope","_",a])}.call(this),function(){angular.module("conta").factory("_",function(){return window._})}.call(this),function(){var a;a=function(b,c,d){return a={clear:function(){return window.sessionStorage.clear(),c.remove("clientId",{domain:".nubank.com.br"}),c.remove("clientSecret",{domain:".nubank.com.br"}),d.$broadcast("clearData"),!0}}},angular.module("conta").factory("UserSession",["$window","ipCookie","$rootScope",a])}.call(this),function(){var a;a=d3.locale({decimal:",",thousands:".",grouping:[3],currency:["R$ ",""],dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]}),angular.module("conta").factory("d3_locale_ptBR",function(){return a})}.call(this),function(){"use strict";var a,b;b=function(a,b){return{restrict:"E",transclude:!0,templateUrl:"components/navigation/navigation-base.template.html",link:function(c){return c.location=a,c.menuDisplay=!1,c.$watch("location.path()",function(a){return"/login"===a?(b.clear(),c.menuDisplay=!1):"/invitation"===a?c.menuDisplay=!1:"/account-recovery"===a?c.menuDisplay=!1:"/account-recovery/confirmed"===a?c.menuDisplay=!1:"/account-recovery/expired"===a?c.menuDisplay=!1:"/account-recovery/error"===a?c.menuDisplay=!1:c.menuDisplay=!0})}}},a=function(){return function(a,b){return a.$on("loader_show",function(){return $(b).show()}),a.$on("loader_hide",function(){return $(b).hide()})}},angular.module("conta").directive("navigationBase",["$location","UserSession",b]).directive("loader",["$rootScope",a])}.call(this),function(){"use strict";var a;a=function(a){return{restrict:"E",scope:{customer:"=",account:"="},templateUrl:"components/navigation/navigation-menu.template.html",link:function(b){var c,d,e,f,g;g=a.$$path.split("/")[1],d=".menu-item."+g,c="active-item",f=".nu-menu-profile",e=function(a){var b;return $(".top-bar-section li").removeClass(c),b=$(a).is("li")?$(a):$(a).parent(),b.addClass(c)},$(".nu-menu li").click(function(){return e(this)}),$(".nu-menu-profile li").click(function(){return e(f)}),e(d),$(".nu-menu-profile").mouseenter(function(){return $(".profile-card").addClass("show")}).mouseleave(function(){if(!$(".profile-card").filter(function(){return $(this).is(":hover")}).length)return $(".profile-card").hide()})}}},angular.module("conta").directive("navigationMenu",["$location",a])}.call(this),function(){"use strict";var a;a=function(a,b){return{restrict:"E",replace:!0,templateUrl:"components/navigation/limit-bar.html",controller:["$scope",function(a){a.highlightBills=function(){var a,b;a=".menu-item.bills",$(".top-bar-section li").removeClass("active-item"),b=$(a).is("li")?$(a):$(a).parent(),b.addClass("active-item")}}],link:function(a,c){var d,e;return d=0,a.balances=null,$(c).mouseenter(function(){return $(this).addClass("open")}).mouseleave(function(){return $(this).removeClass("open")}),a.balancePerc=function(b){return a.account?100*b/d:0},e=function(){var c,e,f,g;a.balances=b.account.balances,f=a.balances,g=[];for(e in f)c=f[e],g.push(d+=c);return g},void 0===b.account.balances?a.$on("accountReady",function(){if(null!==b.account.balances&&0===d)return e()}):e()}}},angular.module("conta").directive("limitBar",["Account","$rootScope",a])}.call(this),function(){"use strict";var a,b;b=function(){return{restrict:"E",replace:!0,scope:{name:"="},template:['<li class="has-dropdown profile-menu">','<a class="menu-item profile-title">{{name}}</a>','<ul class="dropdown profile-card">','<li class="profile-link">','<a class="my-account" href="#profile">Meus dados</a>',"</li>","<li>","<logout></logout>","</li>",'<li class="last-transaction">',"<h4>última compra</h4>","<tx-latest></tx-latest>","</li>",'<li class="block">',"<card-block></card-block>","</li>","</ul>","</li>"].join("",{link:function(a){return $(element).mouseleave(function(){return $(this).hide()})}})}},a=function(a,b,c){return{restrict:"E",replace:!0,template:'<a ng-click="logout()" class="logout">Sair</a>',link:function(d,e){return $(e).click(function(){return b.clear(),a.logout(c.links.revoke_token,"/login"),amplitude.logEvent("Auth: Logout")})}}},angular.module("conta").directive("profileCard",b).directive("logout",["auth","UserSession","$rootScope",a])}.call(this),function(){"use strict";var a;a=function(a,b,c,d,e){var f,g;return b.$watch("customer",function(a){if(null!==a)return g()}),g=function(){var a,c,d;if(null!==b.customer)return a=null!=(c=null!=(d=b.customer)?d.phone:void 0)?c:"","55"===a.substring(0,2)?b.display_phone=a.substring(2):b.display_phone=a},f=function(a,b){return{message:a,type:b}},b.revokeToken=function(){if(confirm("Isso fará com que todos os dispositivos logados com essa conta se desloguem. Tem certeza que quer revogar o acesso?"))return a.logout(c.links.revoke_all,"/login")},b.updateEmail=function(a){return d.post(b.customer._links.update_email.href,JSON.stringify({customer:{email:a}})).success(function(){return b.emailUpdate=f("E-mail atualizado.","success"),amplitude.logEvent("Account: Change email")}).error(function(){return b.emailUpdate=f("Houve um erro, por favor, tente novamente.","failure")})},b.updatePhone=function(a){var c;if(c=10===a.length||11===a.length)return d.post(b.customer._links.update_phone.href,JSON.stringify({customer:{phone:"55"+a}})).success(function(){return b.phoneUpdate=f("Telefone atualizado.","success"),amplitude.logEvent("Account: Change phone")}).error(function(){return b.phoneUpdate=f("Houve um erro, por favor, tente novamente.","failure")})},b.updatePassword=function(c,e){var g,h,i,j,k,l;return g=b.customer.cpf,l=function(a,c,d,e){return b.passwordUpdate=f("Senha atualizada.","success"),amplitude.logEvent("Account: Change password")},k=function(a,c,d,e){b.passwordUpdate=f("Houve um erro, por favor, tente novamente.","failure"),passwordAttempts++},j=function(){return d.post(a.getLink("change_password"),JSON.stringify({password:e})).success(function(){return h(g,e,l,k)}).error(function(a){b.passwordUpdate=f("Houve um erro, por favor, tente novamente.","failure")})},i=function(){b.passwordUpdate=f("Houve um erro, por favor, tente novamente.","failure")},(h=function(b,c,d,e){return a.login(b,c).then(d,e)})(g,c,j,i)},b.contactNu=function(){return window.location="mailto:todomundo@nubank.com.br"},$(".top-bar-section li").removeClass("active-item")},angular.module("conta").controller("ProfileCtrl",["auth","$scope","$rootScope","$http","$interval",a])}.call(this),function(){"use strict";var a;a=angular.module("conta"),a.controller("BillsCtrl",function(){})}.call(this),function(){"use strict";var a,b,c,d;b=function(a,b,c,d,e,f,g,h){return{restrict:"E",scope:{account:"="},templateUrl:"components/bills/bills-browser.template.html",link:function(a){var h,i,j,k;return j=0,a.tabContentStyle={},k=function(){return j=f.innerHeight-166,a.tabContentStyle={height:j+"px"},$(".bills .md-tabs-content").height(j)},k(),angular.element(f).on("resize",k),d.currentBill=null,i=function(){return d.getSummary().then(function(b){return a.bills=b,d.loadBills(),a.$on("firstBillLoaded",function(){return g(function(){return a.selectedIndex=d.currentBill},500)})})},c.account._links&&i(),c.$on("accountReady",function(){return i()}),a.abs=function(a){return Math.abs(a)},a.zeroNegative=function(a){return a<0?0:a},a.billState=function(a){return"overdue"===a.status?"anterior":"closed"===a.status?"atual":"open"===a.status?"aberta":void 0},a.showBillBarcode=function(c){return a.boletoModal=b.open({templateUrl:"bill-barcode.template.html",controller:"billBoletoModal",resolve:{bill:function(){return c}}}),amplitude.logEvent("Bill: Generate boleto")},a.sendInvoice=function(a,b){return d.requestInvoice(a.href).then(function(a){return $(".invoice-for-"+b).show(400),amplitude.logEvent("Bill: Send by email")})},h=function(a,b){var c,d,f,g,h,i,j,k,l;switch(c=a.summary.due_date.substr(0,7),l=navigator.appVersion.toString(),b){case"csv":d=e.toCSV(a),k="text/csv",i="nubank-"+c+".csv",amplitude.logEvent("Bill: Export to CSV");break;case"ofx":d=e.toOFX(a),k="application/x-ofx",i="nubank-"+c+".ofx",amplitude.logEvent("Bill: Export to OFX")}l.indexOf(".NET")>0||l.indexOf("Edge")>0?(h=new Blob([d],{type:k}),window.navigator.msSaveBlob(h,i)):(j="data:"+k+";charset=utf-8,",f=angular.element("<a/>"),f.attr({href:j+encodeURIComponent(d),target:"_blank",download:i}),g=new MouseEvent("click",{bubbles:!0,view:window}),f[0].dispatchEvent(g))},a.exportToCSV=function(a){return h(a,"csv")},a.exportToOFX=function(a){return h(a,"ofx")}}}},a=function(a,b,c,d){var e;return a.bill=c,d.getBarcode(c).then(function(b){return a.bill.readable_barcode=b.data.readable_barcode,$("#barcode-"+c.summary.due_date).JsBarcode(b.data.barcode,{format:"Inter25"}),!0}),a.getBoletoEmail=function(a){var b;return b=parseInt($("#boleto-amount").val().replace(/[^\d]/g,""),10),d.requestBoletoEmail(a,b).then(function(a){return $(".toast-boleto-sent").show(400),amplitude.logEvent("Bill: Send by email")}),!0},a.hideBillBarcode=function(){return b.dismiss(),!0},e=function(a,b,c){return a<c?"< Min":a===c?"Min":a<b?"Min < Total":a===b?"Total":a>b?"> Total":void 0},$(".transaction-editor").css("height","auto"),$(document).keydown(function(a){var b;if(b=parseInt($("#boleto-amount").val().replace(/[^\d.]/g,""),10),(a.metaKey||a.crtlKey)&&67===a.which&&window.getSelection().focusNode&&0===window.getSelection().focusNode.parentElement.className.indexOf("barcode"))return amplitude.logEvent("Bill: Copy boleto nubmer")})},d=function(a,b){return{restrict:"E",replace:!0,scope:{state:"=",index:"="},link:function(b){if(null===a.currentBill&&("closed"===b.state||"open"===b.state))return a.currentBill=b.index}}},c=function(a){return{restrict:"E",replace:!0,scope:{bill:"="},template:['<div class="charges-list">','<div class="failedBill" ng-if="failed"> <h4>Desculpe, não conseguimos carregar sua fatura :(</h4> <p>Tente atualizar a página ou entre em contato conosco.</p> </div>','<div class="charge" ng-repeat="charge in charges" ng-if="!failed"">','<div class="time" >','<div class="cell">','<span class="date">{{charge.post_date | day_month}}</span>',"</div>","</div>",'<div class="charge-data" ng-class="isCharge(charge.amount)">','<div class="description">{{charge.title}} <em ng-if="charge.charges > 1">{{ charge.index + 1 }}/{{ charge.charges }}</em></div>','<div class="amount">{{charge.amount/100 | number:2 }}</div>',"</div>","</div>"].join(""),link:function(b){return b.$watch("$last",function(){return a(function(){return $(".description").minEmoji()})})},controller:["$scope",function(a){return a.bill.more===-1&&(a.failed=!0),a.charges=a.bill.more.line_items,a.isCharge=function(a){if(a<0)return"credit"}}]}},angular.module("conta").directive("billBrowser",["$filter","$modal","$rootScope","Bills","billsExporter","$window","$timeout","_",b]).directive("setCurrent",["Bills","$rootScope",d]).directive("billCharges",["$timeout",c]).controller("billBoletoModal",["$scope","$modalInstance","bill","Bills",a])}.call(this),function(){"use strict";var a,b,c,d;b={OFXDate:function(a){return a?moment(a).format("YYYYMMDD")+"000000[-3:GMT]":null},value:function(a){return a/100},title:function(a){var b;return b=a.charges>1?" "+(a.index+1)+"/"+a.charges:"",a.title+b}},c={fileHeader:function(){var a;return a=["OFXHEADER:100","DATA:OFXSGML","VERSION:102","SECURITY:NONE","ENCODING:USASCII","CHARSET:1252","COMPRESSION:NONE","OLDFILEUID:NONE","NEWFILEUID:NONE"],a.join("\n")},tag:function(a,b,c){return null==c&&(c=!0),"\n<"+a+">"+b+(c?"</"+a+">\n":"")},openTag:function(a,b){return c.tag(a,b,!1)},authenticationBlock:function(){return c.tag("SIGNONMSGSRSV1",c.tag("SONRS",c.statusBlock()+c.openTag("DTSERVER",b.OFXDate(new Date))+c.openTag("LANGUAGE","POR")+"\n"))},accountInfo:function(a){return c.openTag("CURDEF","BRL"+c.tag("CCACCTFROM",c.openTag("ACCTID",a)+"\n"))},transaction:function(a){return c.tag("STMTTRN",c.openTag("TRNTYPE",a.amount<0?"CREDIT":"DEBIT")+c.openTag("DTPOSTED",b.OFXDate(a.post_date))+c.openTag("TRNAMT",b.value(a.amount)*-1)+c.openTag("FITID",a.id)+c.openTag("MEMO",b.title(a))+"\n")},transactionsList:function(a,d,e){var f;return c.tag("BANKTRANLIST",c.openTag("DTSTART",b.OFXDate(a)+c.openTag("DTEND",b.OFXDate(d)+function(){var a,b,d;for(d=[],a=0,b=e.length;a<b;a++)f=e[a],d.push(c.transaction(f));return d}().join(""))))},ledgerBalance:function(a,d){return c.tag("LEDGERBAL",c.openTag("BALAMT",b.value(a*-1)+c.openTag("DTASOF",b.OFXDate(d)+"\n")))},statusBlock:function(){return c.tag("STATUS",c.openTag("CODE","0"+c.openTag("SEVERITY","INFO\n")))},structure:function(a,b,d,e,f){return c.tag("OFX",c.authenticationBlock()+c.tag("CREDITCARDMSGSRSV1",c.tag("CCSTMTTRNRS",c.openTag("TRNUID","1001"+c.statusBlock()+c.tag("CCSTMTRS",c.accountInfo(a)+c.transactionsList(d,e,f)+c.ledgerBalance(b,e))))))},generate:function(a,b,d,e,f){return[c.fileHeader(),c.structure(a,b,d,e,f)].join("")}},a={headers:["date","category","title","amount"],transaction:function(a){return[a.post_date,a.category,b.title(a),b.value(a.amount)].join(",")},generate:function(b){var c,d;return c=function(){var c,e,f;for(f=[],c=0,e=b.length;c<e;c++)d=b[c],f.push(a.transaction(d));return f}(),[a.headers].concat(c).join("\n")}},d=function(){return{toOFX:function(a){return c.generate(a.id,a.summary.total_balance,a.summary.open_date,a.summary.close_date,a.more.line_items)},toCSV:function(b){return a.generate(b.more.line_items)}}},angular.module("conta").service("billsExporter",d)}.call(this),function(){"use strict";var a,b,c;a=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p,q,r;$(window).scrollTop(350),b.load({name:"Emoji",files:["js/vendor/jMinEmoji.js"]}),o={time:[],tags:[],categories:[]},a.$on("transactionsReady",function(){return p()}),a.$on("reloadTransactionsPanel",function(){l.needUpdate&&(o={time:c.getFilters(),tags:e.getFilters(),categories:d.getFilters()},l.getTransactions(!0).then(function(b){q(),a.transactions.remove(),a.transactions.add(b),c.setFilters(o.time),c.generateGraph("#timeChart",a.transactions),d.setFilters(o.categories),d.generateGraph("#categoryChart",a.transactions),e.setFilters(o.tags),e.generateGraph("#tagChart",a.transactions),f.generateMap("map-div",a.transactions,l.all),dc.redrawAll(),m.reset(),l.needUpdate=!1}))}),a.$on("filteredTransactions",function(){return $(".summary").show(200)}),a.$on("clearedTransactionsFilters",function(){return $(".summary").hide(200)}),a.transactions={search:null},a.$on("clearSearchFilter",function(){return a.transactions.search=""}),a.$watch("transactions.search",function(a){if(null!==a&&void 0!==a)return j.filterText(a)}),p=function(){return l.getTransactions().then(function(){return a.transactions=crossfilter(l.all),r()}).then(function(){return $(".transactions").removeClass("loading")})},q=function(){return g.resetFilters(),c.resetFilters(),d.resetFilters(),e.resetFilters()},r=function(){k.get(a.transactions),f.generateMap("map-div",a.transactions,l.all),g.generateTable("#feedTable",a.transactions),c.generateGraph("#timeChart",a.transactions),d.generateGraph("#categoryChart",a.transactions),e.generateGraph("#tagChart",a.transactions),i.generateCountWidget("#countWidget",a.transactions),i.generateSumWidget("#sumWidget",a.transactions),j.setTextFilter(a.transactions)},$("#timeChart .header").mouseenter(function(){return $("#timeChart").addClass("open")}).mouseleave(function(){if(!$("#timeChart").is(":hover"))return $("#timeChart").removeClass("open")}),$("#timeChart").mouseleave(function(){return $("#timeChart").removeClass("open")}),l.all&&!l.needUpdate&&p()},c=function(a,b){return{textAccessor:function(a){var b,c,d,e,f;if(f="","transaction"===a.category&&null!=a.details.tags)for(d=a.details.tags,b=0,c=d.length;b<c;b++)e=d[b],f+=e;return _.unescape(a.title+a.description+f).toUpperCase()},textDimension:null,filterText:function(c){return this.textDimension.filterFunction(function(a){return""===c||a.indexOf(c.toUpperCase())>-1}),a.updateMap(),b.$broadcast("filteredTransactions"),b.$broadcast("updateChartHeight"),dc.renderAll()},setTextFilter:function(a){return this.textDimension=a.dimension(this.textAccessor)}}},b=function(){return{restrict:"A",link:function(a,b,c){var d;return d="."+c.resetControl,$(b).on("click",function(a){return $(b).find(".reset:visible").length?$(d).show():$(d).hide()})}}},angular.module("conta").controller("TransactionsCtrl",["$scope","$ocLazyLoad","txTimeGraph","categoryGraph","tagGraph","transactionMap","transactionTable","transactionTableRenders","valueWidget","textSearch","lastTx","Transactions","Bills","_",a]).service("textSearch",["transactionMap","$rootScope",c]).directive("resetControl",b)}.call(this),function(){"use strict";var a;a=function(a,b,c){var d,e,f,g,h;return f=6048e5,e=2592e6,d=["rgba(255,255,255,0.7)"],h=null,g=[],{getFilters:function(){return h.filters()},setFilters:function(a){return g=a},resetFilters:function(){return h.filterAll()},generateGraph:function(i,j){var k,l,m,n;return h=dc.barChart(i),l=j.dimension(function(a){return a.week}),k=l.group().reduceSum(function(a){return a.crossfilter_amount>0?a.crossfilter_amount/100:0}),h.width(720).height(192).x(d3.time.scale().domain([d3.time.week(new Date(Date.parse(l.bottom(1)[0].time))),d3.time.saturday(new Date(Date.parse(l.top(1)[0].time)+f))])).xUnits(d3.time.weeks).round(d3.time.week.round).filterPrinter(function(a){return b.timeFormat("%d %b %y")(a[0][0])+" - "+b.timeFormat("%d %b %y")(a[0][1])}).brushOn(!0).elasticY(!1).yAxisLabel("R$",16).dimension(l).renderHorizontalGridLines(!0).colors(d).colorAccessor(function(a,b){return b%4}).group(k).transitionDuration(450).gap(16).centerBar(!0).margins({top:25,left:65,right:20,bottom:25}).xAxis().ticks(4).tickFormat(function(a){return b.timeFormat("%d %b %y")(new Date(a))}),h.yAxis().ticks(5).tickFormat(b.numberFormat(",d")),g.length?h.filter([d3.time.sunday(new Date(Date.parse(g[0][0]))),d3.time.saturday(new Date(Date.parse(g[0][1])+f))]):(n=Date.parse(l.top(1)[0].time)-e,m=Date.parse(l.bottom(1)[0].time),h.filter([d3.time.sunday(new Date(m<n?n:m)),d3.time.saturday(new Date(Date.parse(l.top(1)[0].time)+f))])),h.on("filtered",function(b,d){return c.$broadcast("updateChartHeight"),d&&(c.$broadcast("filteredTransactions"),amplitude.logEvent("Feed: Filtered Transactions",{Type:"Period of time",Term:"weekly-filter"})),a.updateMap()}),dc.renderAll()}}},angular.module("conta").service("txTimeGraph",["transactionMap","d3_locale_ptBR","$rootScope",a])}.call(this),function(){"use strict";var a,b;a=function(a,b){var c,d,e,f,g,h;if(c=a._links?a._links.self.href:"",f="<div class='event-card info-window' id='"+a.id+"' data-link='"+c+"'>",f+="card_not_present"===a.details.subcategory?"<img class='type' src='../../images/nu-icon-pod-online.png' />":"<img class='type' src='../../images/nu-icon-pod-place.png' />",f+="<span class='category'>"+a.title+"</span> <h4 class='merchant'>"+a.description+"</h4> <div class='amount'>"+b.numberFormat("$,.2f")(a.amount/100)+"</div>",f+="<span class='tags'>",null!=a.details.tags)for(g=a.details.tags,d=0,e=g.length;d<e;d++)h=g[d],f+="<span class='tag'>"+h+" </span>";return f+="</span>",f+="<span class='time'>"+b.timeFormat("%e %B")(new Date(Date.parse(a.time)))+"</span> </div>"},b=function(b,c,d){return{markers:[],map:null,pointIds:[],updateMap:function(){var a,b,c,e;if(this.cluster.clearLayers(),b=this.markers,c=d.map(d.filter(this.pointIds,function(a){return b[a.key]&&a.value>0}),function(a){return a.key}),e=d.map(c,function(a){return b[a]}),this.cluster.addLayers(e),a=new L.LatLngBounds,0!==e.length)return d.each(e,function(b){if(b.getLatLng()&&b.getLatLng().lat)return a.extend(b.getLatLng())}),this.map.fitBounds(a)},generateMap:function(e,f,g){var h,i,j,k,l,m,n,o,p,q,r;return l=f.dimension(function(a){return a.lat-2}),m=f.dimension(function(a){return a.lon}),k=[l.bottom(1)[0].lat||-23.55,m.bottom(1)[0].lon||-46.6333],L.Icon.Default.imagePath="images",h=L.Icon.Default.extend({options:{iconUrl:"/images/maps-pin.svg",iconAnchor:[10,25],popupAnchor:[0,-12],shadowSize:[0,0]}}),this.map=L.map(e,{center:k,zoom:8,minZoom:2,maxZoom:18,attributionControl:!1}).setView(k),n=this.map,L.control.attribution({position:"bottomleft",prefix:!1}).addTo(n),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'}).addTo(n),amplitude.logEvent("Map: request",{View:"Transactions"}),this.cluster=new L.MarkerClusterGroup({disableClusteringAtZoom:14}),p=d.filter(g,function(a){return"transaction"===a.category}),q=d.filter(p,function(a){return a.details.lat&&a.details.lon}),o=this.markers,r=d.map(q,function(b){var d,e,f,g;return f=b.details,d=L.marker([f.lat,f.lon],{icon:new h}),e=a(b,c),g=L.popup({offset:L.point(0,-24)}).setLatLng([f.lat,f.lon]).setContent(e),d.bindPopup(g),d.transactionId=b.id,o[b.id]=d}),this.cluster.addLayers(r),this.cluster.addTo(n),n.on("popupopen",function(a){return $(".info-window").click(function(){return b.openDetails(this)})}),i=f.dimension(function(a,b){return a.id}),j=i.group(function(a){
return a}),this.pointIds=j.all(),setTimeout(this.updateMap(),500)}}},angular.module("conta").service("transactionMap",["Transactions","d3_locale_ptBR","_",b])}.call(this),function(){"use strict";var a,b;a=function(a,b,c,d,e,f){var g;return g=null,{resetFilters:function(){return g.filterAll()},generateTable:function(a,b){var c;return g=dc.dataTable(a),c=b.dimension(function(a){return new Date(Date.parse(a.time))}),g.expireCache().dimension(c).size(c.bottom(1/0).length).sortBy(function(a){return-Date.parse(a.time)}).order(d3.time.ascending).renderlet(function(a){return a.selectAll(".dc-table-row").classed("info",!0)}).group(function(a){return d.timeFormat.utc("%d/%b/%Y")(new Date(Date.parse(a.time)))}).columns([function(a){var b,c,e,f,g;if(e="transaction"===a.category||"transaction_reversed"===a.category?"<div class='event-card "+a.category+" "+a.details.subcategory+"' id='"+a.id+"' data-link='"+(a._links?a._links.self.href:void 0)+"'>":"<div class='event-card event "+a.category+"' id='"+a.id+"'>",e+="<div class='type'></div> <span class='title'>"+a.title+"</span>",a.description&&(e+="<h4 class='description'>"+a.description+"</h4>"),a.amount&&(e+="<div class='amount'>"+d.numberFormat("$,.2f")(a.amount/100)+"</div>"),a.details&&a.details.fx&&a.details.fx.currency_origin&&(e+="<div class='fx'>"+a.details.fx.currency_origin+" "+d.numberFormat(".2f")(a.details.fx.amount_origin/100)+"</div>"),e+="<span class='tags'>",("transaction"===a.category||"transaction_reversed"===a.category)&&null!=a.details.tags)for(f=a.details.tags,b=0,c=f.length;b<c;b++)g=f[b],e+="<span class='tag'>"+g+"</span>";return e+="</span> <span class='time'>"+d.timeFormat("%e %b")(new Date(Date.parse(a.time)))+"</span> </div>","transaction"!==a.category&&"transaction_reversed"!==a.category||(e+="<div class='hover'></div>"),e+="</div>"}]),g.on("postRedraw",function(){return e.enableExtraDetails(),e.reviewEmoji(),e.enableEditor()}),g.on("postRender",function(){return e.enableExtraDetails(),e.reviewEmoji(),e.enableEditor()})}}},b=function(a){return{reviewEmoji:function(){return $(".event-card h4, .tag, .dc-chart text").minEmoji()},enableExtraDetails:function(){return $(".more").parent().bind("mouseenter",function(){return $(this.lastChild).show()}),$(".more").parent().bind("mouseleave",function(){return $(this.lastChild).hide()})},enableEditor:function(){return $(".event-card:not(.event)").click(function(){return a.openDetails(this)})}}},angular.module("conta").service("transactionTable",["transactionMap","tagGraph","categoryGraph","d3_locale_ptBR","transactionTableRenders","$rootScope",a]).service("transactionTableRenders",["Transactions","$rootScope","textSearch",b])}.call(this),function(){var a;a=function(a,b,c){var d,e,f;return d=["#D0D0D0"],e=null,f=[],{getFilters:function(){return e.filters()},setFilters:function(a){return f=a},resetFilters:function(){return e.filterAll()},addFilter:function(a){return e.filter(a),dc.renderAll()},generateGraph:function(g,h){var i,j,k,l,m,n,o,p,q,r,s;for(e=dc.rowChart(g),k=h.dimension(function(a){return a.title}),p=function(a,b){return"transaction"===b.category&&(a[b.title]=(a[b.title]||0)+b.crossfilter_amount/100),a},r=function(a,b){return"transaction"===b.category&&(a[b.title]=(a[b.title]||0)-b.crossfilter_amount/100),a},q=function(){return{}},i=[],l=k.groupAll().reduce(p,r,q).value(),l.all=function(){var a,b,c;b=[];for(a in this)c=this[a],"all"!==a&&c>0&&b.push({key:a,value:this[a]});return b=_.sortBy(b,"value"),b.reverse()},j=l.all().length,$(".catsChart").toggle(!!j),e.width(208).ordering(function(a){return-a.value}).height(30*j+24).margins({top:0,left:4,right:0,bottom:20}).group(l).colors(d).dimension(k).transitionDuration(300).elasticX(!0).filterHandler(function(a,b){return 0===b.length?a.filter(null):a.filterFunction(function(a){var c;return c=!1,b.indexOf(a)>=0&&(c=!0),c}),b}).labelOffsetX(0).labelOffsetY(14).gap(6).title(function(a){return b.numberFormat("$,.2f")(a.value)}).xAxis().ticks(4).tickFormat(b.numberFormat(",d")),n=0,o=f.length;n<o;n++)m=f[n],e.filter(m);return e.on("filtered",function(b,d){if(c.$broadcast("updateChartHeight"),a.updateMap(),d)return c.$broadcast("filteredTransactions"),amplitude.logEvent("Feed: Filtered Transactions",{Type:"Category",Term:d})}),c.$on("updateChartHeight",function(){var a,b;a=l.all().length,b=30*a+24,$(".catsChart").toggle(a>0),e.height(b).svg().attr("height",b),e.render()}),s=function(a){return $(a.toElement).hide(),e.filterAll(),dc.renderAll()},document.getElementById(g.substring(1)+"-reset").addEventListener("click",s,!1),dc.renderAll()}}},angular.module("conta").service("categoryGraph",["transactionMap","d3_locale_ptBR","$rootScope",a])}.call(this),function(){var a;a=function(a,b,c,d){var e,f,g;return e=["#D0D0D0"],g=null,f=[],{getFilters:function(){return g.filters()},setFilters:function(a){return f=a},addFilter:function(a){return g.filter(a),dc.renderAll()},resetFilters:function(){return g.filterAll()},generateGraph:function(h,i){var j,k,l,m,n,o,p,q,r,s,t;for(g=dc.rowChart(h),s=i.dimension(function(a){if("transaction"===a.category&&null!=a.details.tags)return a.details.tags}),n=function(a,b){return"transaction"===b.category&&null!=b.details.tags&&b.details.tags.forEach(function(c){return a[c]=(a[c]||0)+b.crossfilter_amount/100}),a},p=function(a,b){return"transaction"===b.category&&null!=b.details.tags&&b.details.tags.forEach(function(c){return a[c]=(a[c]||0)-b.crossfilter_amount/100}),a},o=function(){return{}},j=[],r=d.throttle(function(){return s.groupAll().reduce(n,p,o).value()},600)(),r.all=function(){var a,b,c;b=[];for(a in this)c=this[a],this.hasOwnProperty(a)&&"all"!==a&&c>0&&b.push({key:a,value:this[a]});return b=d.sortBy(b,"value"),b.reverse()},t=r.all().length,$(".catsChart").toggle(!!t),g.width(208).ordering(function(a){return-a.value}).height(30*t+24).margins({top:0,left:4,right:0,bottom:20}).group(r).transitionDuration(300).colors(e).dimension(s).elasticX(!0).filterHandler(function(a,b){return 0===b.length?a.filter(null):a.filterFunction(function(a){var c;if(c=!1,a)return a.forEach(function(a){if(b.indexOf(a)>=0)return c=!0}),c}),b}).labelOffsetX(0).labelOffsetY(14).gap(8).title(function(a){return b.numberFormat("$,.2f")(a.value)}).xAxis().ticks(4).tickFormat(b.numberFormat(",d")),l=0,m=f.length;l<m;l++)k=f[l],g.filter(k);return g.on("filtered",function(b,d){if(c.$broadcast("updateChartHeight"),a.updateMap(),d)return c.$broadcast("filteredTransactions"),amplitude.logEvent("Feed: Filtered Transactions",{Type:"Tag",Term:d})}),c.$on("updateChartHeight",function(){var a,b;a=r.all().length,b=30*a+24,$(".tagsChart").toggle(a>0),g.height(b).svg().attr("height",b),g.render()}),q=function(a){return $(a.toElement).hide(),g.filterAll(),dc.renderAll()},document.getElementById(h.substring(1)+"-reset").addEventListener("click",q,!1),dc.renderAll()}}},angular.module("conta").service("tagGraph",["transactionMap","d3_locale_ptBR","$rootScope","_",a])}.call(this),function(){"use strict";var a;a=function(a){return{add_data_count_and_total:function(a,b){return b.crossfilter_amount>0?(a.n+=1,a.tot+=b.crossfilter_amount/100):(a.tot+=0,a.n+=0),a},subtract_data_count_and_total:function(a,b){return b.crossfilter_amount>0?(a.n-=1,a.tot-=b.crossfilter_amount/100):(a.tot-=0,a.n-=0),a},initial_data_count_and_total:function(){return{n:0,tot:0}},generateSumWidget:function(b,c){var d,e;return d=c.groupAll().reduce(this.add_data_count_and_total,this.subtract_data_count_and_total,this.initial_data_count_and_total),e=dc.numberDisplay(b),e.valueAccessor(function(a){return a.tot}).group(d).formatNumber(a.numberFormat(",.2f")),dc.renderAll()},generateCountWidget:function(a,b){var c,d;return c=b.groupAll().reduce(this.add_data_count_and_total,this.subtract_data_count_and_total,this.initial_data_count_and_total),d=dc.numberDisplay(a),d.valueAccessor(function(a){return a.n}).group(c).formatNumber(d3.format(",.0f")),dc.renderAll()}}},angular.module("conta").service("valueWidget",["d3_locale_ptBR",a])}.call(this),function(){"use strict";var a,b;b=function(a){return{restrict:"E",scope:{},template:['<p class="last-tx">','<span class="time">{{ tx.time }}</span><br />','<span class="merchant">{{ tx.merchant }}</span><br/>','<span class="amount" ng-if="tx.amount">{{ tx.amount | in_reais }}</span>',"</p>"].join(""),link:function(b){return b.tx={time:"Sem informação disponível",merchant:"",amount:0},b.$on("lastTransactionReady",function(){return b.tx.time=moment(a.last.time).format("DD MMMM"),b.tx.merchant=a.last.description,b.tx.amount=a.last.amount})}}},a=function(a){return{get:function(b){var c,d;if(c=b.dimension(function(a){return a.time}),d=_.find(c.top(20),function(a){return"transaction"===a.category}))return a.setLast(d)}}},angular.module("conta").directive("txLatest",["Transactions",b]).service("lastTx",["Transactions",a])}.call(this),function(){"use strict";var a,b;b=function(a,b,c,d,e,f,g){var h,i,j,k,l;return a.marker={},a.map={},a.tx=f.data.transaction,a.tx.txTime=g.timeFormat("%d %b %y - %H:%M")(new Date(Date.parse(a.tx.time))),a.close=function(){return d.dismiss()},a.categoriesList=e.categories,a.tx.activeCategory=a.tx.mcc,a.tx.activeMerchant=a.tx.merchant_name,a.editor={},h=0,l=0,j=0,i=0,k=a.tx.mcc,a.modelTransaction=c.find(e.all,function(b){return b.id===a.tx.id}),amplitude.logEvent("Transaction Details: View",{Source:"Feed"}),a.addTag=function(b){return e.addTag(a.tx._links,b).then(function(c){return b._links=c.data.tag._links,a.modelTransaction.tags=a.tx.tags,amplitude.logEvent("Transaction Details: Add tag",{Attempts:h,"Tag Type":b.description}),h=0,e.needUpdate=!0}).catch(function(){return h++})},a.removeTag=function(b){return e.removeTag(b).then(function(){return a.modelTransaction.tags=a.tx.tags,amplitude.logEvent("Transaction Details: Remove tag",{Attempts:l,"Tag Type":b.description}),l=0,e.needUpdate=!0}).catch(function(){return l++})},a.changeCategory=function(){return e.setCategory(a.tx._links,a.tx.activeCategory).then(function(){return a.modelTransaction.mcc=a.tx.activeCategory,amplitude.logEvent("Transaction Details: Change category",{Attempts:i,"Old Category":k,"New Category":a.tx.activeCategory}),i=0,e.needUpdate=!0}).catch(function(){return i++})},a.editor.saveMerchantName=function(b){return e.setMerchantName(a.tx._links,b).then(function(){return a.modelTransaction.merchant_name=b,amplitude.logEvent("Transaction Details: Adjust merchant name",{Attempts:j}),j=0,e.needUpdate=!0}).catch(function(){return j++})},a.editor.clearMerchantName=function(){a.tx.activeMerchant=a.tx.merchant_name}},a=function(){return{restrict:"A",link:function(a,b){var c;c=function(){var a;return a=$("html").height(),$(b).hasClass("data")?void $(b).css("min-height",a-238+"px"):void($(b).hasClass("height-content")?$(b).css("height",a-144+"px"):$(b).css("height",a-64+"px"))},c(),$(window).resize(function(){return c()})}}},angular.module("conta").controller("transactionEditor",["$scope","$http","_","$modalInstance","Transactions","transactionData","d3_locale_ptBR",b]).directive("setWindowHeight",a)}.call(this),function(){"use strict";var a;a=function(a){return{restrict:"E",priority:1,require:"?ngModel",replace:!0,template:['<div class="search">','<a class="clear fa fa-close" ng-click="clearSearch()"></a>','<md-input-container id="transaction-text-search" class="nu">',"<label>Nome da loja, categoria ou tag</label>",'<input type="search" ng-model="transactions.search" ng-model-options="{debounce:770}" id="tx-search" tabindex="1" />',"</md-input-container>","</div>"].join(""),link:function(b,c){var d,e;return d=$(c).find(".clear"),e=$(c).find("input"),e.on("focus",function(){d.show()}).on("blur",function(){""===e.val()&&d.hide()}),b.clearSearch=function(){a.$broadcast("clearSearchFilter"),d.hide()}}}},angular.module("conta").directive("txSearchfield",["$rootScope",a])}.call(this),function(){var a;a=function(){return{restrict:"E",scope:{transaction:"="},replace:!0,template:'<p class="type" ng-class="type">{{ label }}</p>',link:function(a){if(a.type="",a.label="","unsettled"===a.transaction.status||"settled"===a.transaction.status||"phasing"===a.transaction.status){if(a.transaction.fx)return a.type="international",void(a.label="internacional");a.transaction.charges>1&&(a.type="installments",a.label="parcelada em "+a.transaction.charges+"x")}else a.type="canceled",a.label="cancelada"}}},angular.module("conta").directive("txTypeLabel",a)}.call(this),function(){var a;a=function(a){return{restrict:"E",replace:!0,scope:{transaction:"="},template:['<div class="location">','<div class="map" id="transactionMap"></div>','<a class="nu-button tiny removeLocation stroke" ng-click="removeLocation()"><i class="fa fa-close"></i> Remover localização</a>',"</div>"].join(""),link:function(b,c){var d,e,f,g;$(c[0]).css("height",$("html").height()-144+"px"),L.Icon.Default.imagePath="images",d=L.Icon.Default.extend({options:{iconUrl:"/images/maps-pin.svg",iconAnchor:[10,25],shadowSize:[0,0]}}),e=[b.transaction.lat,b.transaction.lon],this.map=L.map("transactionMap",{center:e,zoom:18,minZoom:2,maxZoom:20,attributionControl:!1}).setView(e),f=this.map,L.control.attribution({position:"topright",prefix:!1}).addTo(f),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'}).addTo(f),g=L.marker(e,{icon:new d}),g.addTo(f),amplitude.logEvent("Map: request",{View:"Transaction Detail"}),b.removeLocation=function(){return a.removeLocation(b.transaction._links).then(function(){return b.transaction.lat=null,b.transaction.lon=null}).catch(function(){})}}}},angular.module("conta").directive("txMap",["Transactions",a])}.call(this),function(){var a;a=function(){return{restrict:"E",replace:!0,scope:{merchant:"=",editor:"=",label:"@?",value:"=ngModel"},link:function(a,b){var c,d,e;return c=a.value,d=$(b.children()[0]),$(".merchant-name input").on("blur",function(){return e(this.value)}),e=function(d){return d!==c?a.save():b.removeClass("editing")},b.on("click",function(a){if("INPUT"===a.target.nodeName)return b.addClass("editing")}),b.on("keydown",function(b){if(13===b.keyCode)return a.save()}),a.save=function(){return a.editor.saveMerchantName($(".merchant-name input").val()).then(function(){return b.removeClass("editing")})}},template:'<div class="single-form"> <md-input-container class="nu merchant-name"> <label>{{ label }}</label> <input type="text" ng-class="transaction.type" ng-model="value" tabindex="1" ng-model-options="{debounce:700}" /> </md-input-container> <div class="actions"> <a class="clear" ng-click="editor.clearMerchantName()"><span class="fa fa-close"></span></a> <a class="nu-button stroke small" ng-click="save()">Alterar</a> </div> </div>'}},angular.module("conta").directive("txNameEditor",a)}.call(this),function(){"use strict";var a,b,c;c=function(a,b,c,d,e){return{template:'<div class="nu-box"> <header> <div class="toolbar login"> <p>Faça seu login</p> </div> <div class="toolbar recover" ng-hide="hideRecover"> <a class="back" ng-click="back()"> <img src="images/back.svg" /> </a> <p>Esqueci minha senha</p> </div> <div class="toolbar qr-scan"></div> <div class="toolbar emergency-access" ng-hide="hideEmergencyAccess"> <a class="back" ng-click="back()"> <img src="images/back.svg" /> </a> </div> </header> <div class="content"> <div class="form-group credentials"> <form name="loginForm" ng-submit="doLogin(user, password)"> <md-input-container id="user" class="nu"> <label>{{t(username)}}</label> <input type="text" ng-model="user" id="username" required ui-br-cpf-mask /> </md-input-container> <md-input-container id="user" class="nu"> <label>{{t(\'password\')}}</label> <input type="password" ng-model="password" required ng-minlength="8" /> </md-input-container> <span class="errormsg wrong-login">{{errorDisplay.login}}</span> <button type="submit" class="nu-button stroke login-btn" ng-disabled="loginForm.$invalid"> {{t("signinbutton")}} </button> </form> <div class="recover-links"> <a class="link" ng-click="showRecover()"> <span>Esqueci minha senha</span> <i class="fa fa-angle-right"></i> </a> <a class="link" href="https://nubank.com.br/pedir/nu/?utm_source=webapp&utm_medium=none"> <span>Ainda não sou cliente</span> <i class="fa fa-angle-right"></i> </a> </div> </div> <div class="form-group recover"> <p class="userinput">Confirme seu CPF para continuar.</p> <div class="userinput"> <form name="recoverForm" ng-submit="doRecover()"> <md-input-container id="user" class="nu"> <label>{{t(username)}}</label> <input type="text" ng-model="recoverUser" ng-disabled="hideRecover" ng-hide="hideRecover" id="recoverUser" required ui-br-cpf-mask/> </md-input-container> <span class="errormsg wrong-cpf">{{ recoverError }}</span> <button type="submit" class="nu-button stroke" ng-disabled="recoverForm.$invalid"> ENVIAR <md-progress-circular md-diameter="20" md-mode="indeterminate"></md-progress-circular> </button> </form> </div> <div class="emailsent"> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 50 50" style="transform: scale(5.0)"> <path fill="#820AD1" fill-rule="nonzero" d="M25 46C12.448 46 4 37.552 4 25S12.448 4 25 4s21 8.448 21 21-8.448 21-21 21zm0-2c11.448 0 19-7.552 19-19S36.448 6 25 6 6 13.552 6 25s7.552 19 19 19zm11.556-25.556L21 34l-8.485-8.485 1.414-1.414L21 31.17 35.142 17.03l1.414 1.415z"/> </svg> <p class="info">Enviamos um link para o seu e-mail cadastrado.</p> <p>Cheque sua caixa de entrada. :)</p> <button type="submit" class="nu-button stroke" ng-click="back(\'reset\')">LOGIN</button> </div> </div> <div class="mfa qr-scan" layout="row" ng-hide="hideQR"> <div class="disclaimer"> <h2>Para acessar sua conta no computador:</h2> <div class="instructions"> <p>1. Abra o App do Nubank no seu celular e toque no ícone <img src="images/nu-person-icon.svg" /> ou <img src="images/nu-settings.svg" /> para acessar o menu de configurações</p> <p>2. Selecione <strong>"Segurança"</strong> e vá para <strong>Acesso no navegador</strong></p> <p>3. Aponte o celular para a tela do computador e escaneie o QR code.</p> </div> </div> <div class="qr-field" layout="column"> <div class="qr-code" /> <div class="reload" style="display:none" ng-click="reloadQR()"> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 50 50" style="transform: scale(-2.0,2.0)"> <path fill="#820AD1" fill-rule="nonzero" d="M11.555 8.243a19.33 19.33 0 0 1 4.899-2.738C19.039 4.51 21.916 4 25 4c3.084 0 5.961.51 8.546 1.505 2.556.982 4.803 2.43 6.66 4.288 1.858 1.857 3.306 4.104 4.29 6.66C45.49 19.04 46 21.917 46 25s-.51 5.96-1.504 8.547c-.984 2.556-2.432 4.803-4.29 6.66-1.857 1.858-4.104 3.306-6.66 4.288C30.961 45.49 28.084 46 25 46c-3.084 0-5.961-.51-8.546-1.505-2.556-.982-4.803-2.43-6.661-4.288-1.858-1.857-3.306-4.104-4.29-6.66C4.51 30.96 4 28.083 4 25h2c0 2.843.466 5.477 1.37 7.829.884 2.297 2.18 4.306 3.837 5.964 1.658 1.658 3.667 2.953 5.965 3.836C19.522 43.533 22.156 44 25 44c2.844 0 5.477-.467 7.828-1.371 2.297-.883 4.307-2.178 5.965-3.836 1.657-1.658 2.952-3.667 3.836-5.964C43.533 30.477 44 27.843 44 25s-.466-5.477-1.37-7.829c-.884-2.297-2.179-4.306-3.836-5.964-1.658-1.658-3.668-2.953-5.965-3.836C30.478 6.467 27.844 6 25 6c-2.844 0-5.478.467-7.828 1.371a17.264 17.264 0 0 0-4.673 2.674l5.853.694-.235 1.986-8.16-.967L8.992 3.6l1.986-.236.578 4.879z"/> </svg> <p>Clique para recarregar<br> o QR code</p> </div> <p class="emergency-access-btn"> <a ng-click="emergencyAccess()" class="emergency-access-btn">Estou sem celular</a> <i class="fa fa-angle-right emergency-access-btn"></i> </p> </div> </div> <div class="mfa emergency-access" ng-hide="hideEmergencyAccess"> <div class="header"> <h2>Acesso sem celular</h2> <p>Por segurança, apenas funções de emergência da sua conta ficam disponíveis sem o celular.</p> </div> <div class="body" layout="row"> <div class="emergency-item boleto"> <button class="nu-button stroke boleto-btn" ng-click="boleto()" ng-disabled="faturaDisabled()"> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 50 50"> <path fill="#820AD1" fill-rule="nonzero" d="M42 0v48.5L40 50l-4-3-4 3-4-3-4 3-4-3-4 3-4-3-4 3V0h34zm-6 44.5l4 3V2H10v44l2-1.5 4 3 4-3 4 3 4-3 4 3 4-3zM28 10v2H14v-2h14zm-4 8v2H14v-2h10zm12 0v2h-4v-2h4zm-12 6v2H14v-2h10zm12 0v2h-4v-2h4zm-12 6v2H14v-2h10zm12 0v2h-4v-2h4zm0 6v2h-8v-2h8z"/> </svg> {{ faturaSent ? "BOLETO ENVIADO" : "ENVIAR BOLETO"}} <md-progress-circular md-diameter="20" md-mode="indeterminate"></md-progress-circular> </button> <p class="happy-text">Envia o boleto da sua última fatura fechada por e-mail.</p> <p class="sad-text">Você não tem nenhuma fatura fechada no momento.</p> <p class="success-text">O boleto foi enviado para o seu e-mail.</p> <p class="error-text">Houve um erro. Tente de novo.</p> </div> <div class="emergency-item block-card"> <button class="nu-button stroke block-card" ng-click="blockCard()" ng-disabled="cardBlocked"> <svg class="lock" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 50 50"> <path fill="#820AD1" fill-rule="evenodd" d="M8 24h28V13c0-6.682-4.318-11-11-11S14 6.318 14 13v1h-2v-1c0-7.776 5.224-13 13-13s13 5.224 13 13v11h4v26H8V24zm2 24h30V26H10v22z"/> </svg> <svg class="unlock" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 50 50" display="none"> <path fill="#CCC" fill-rule="evenodd" d="M38 24h4v26H8V24h4V13c0-7.776 5.224-13 13-13s13 5.224 13 13v11zM10 48h30V26H10v22zm4-35v11h22V13c0-6.682-4.318-11-11-11S14 6.318 14 13z"/> </svg> {{ cardBlocked ? "CARTÃO BLOQUEADO"  : "BLOQUEAR CARTÃO"}} <md-progress-circular md-diameter="20" md-mode="indeterminate"></md-progress-circular> </button> <p class="lock">Bloqueia seu cartão para compras físicas e online.</p> <p class="unlock">Para desbloquear seu cartão, entre em contato com a gente.</p> <p class="error-text">Houve um erro. Tente de novo.</p> </div> <div class="emergency-item logout-all"> <button class="nu-button stroke logout-all-btn" ng-click="logoutAll()"> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"> <path fill-rule="nonzero" d="M5.416 17.715h11.047c1.059 0 1.326-.267 1.326-1.326V2.251c0-1.059-.267-1.326-1.326-1.326H5.416V.041h11.047c1.547 0 2.21.663 2.21 2.21v14.138c0 1.547-.663 2.21-2.21 2.21H5.416v-.884zM1.61 9.762l2.643 3.256-.686.557L.113 9.32l3.454-4.255.686.557L1.61 8.878h11.76v.884H1.61z"/> </svg> DESCONECTAR TUDO <md-progress-circular md-diameter="20" md-mode="indeterminate"></md-progress-circular> </button> <p>Desconecta sua conta de todos os dispositivos logados, app e site.</p> <p class="error-text">Houve um erro. Tente de novo.</p> </div> </div> <div class="footer" layout="row"> <div class="help-text"> <p>Se tiver dúvidas, entre em contato com a gente a hora que quiser:</p> </div> <div class="help-item" layout="column"> <img src="images/email.svg" /> <p class="key">E-mail</p> <a href="mailto:meajuda@nubank.com.br" class="value" style="text-decoration: none">meajuda@nubank.com.br</a> </div> <div class="help-item" layout="column"> <img src="images/phone.svg" /> <p class="key">Telefone</p> <a href="tel:0800 591 2117" class="value" style="text-decoration: none">0800 591 2117</p> </div> </div> </div> <check-status ng-if="startSession" error-log="loginError"></check-status> </div> </div>',restrict:"E",replace:!0,controller:["$scope","$rootScope",function(a,b){return a.username="username",a.startSession=!1,a.errorDisplay={login:null},a.easter_egg=0,a.clearUser=function(a){return a.replace(/[.-]/g,"")},a.t=function(a){return c.app()(a)},a.startAt=null,a.doLogin=function(b,c){var e,f,g;return this.loginForm.$invalid=!0,e=d.login(a.clearUser(b),c),g=function(b,c,d,e){return window.sessionStorage.usersession=!0,a.startSession=!0},f=function(b,c,d,e){if(window.sessionStorage.usersession=null,a.failFn)return a.failFn(b)},e.then(g,f)},a.doSubmitOnEnter=function(b){if(13===b.keyCode)return a.doLogin(a.user,a.password)},a.$on("clearLoginForm",function(){return a.user="",a.password=""})}],link:function(c,f,g){return c.recoverUser="",c.hideRecover=!0,c.hideEmergencyAccess=!0,c.hideQR=!0,c.cardBlocked=!0,c.noFatura=!0,c.faturaSent=!1,c.faturaDisabled=function(){return c.noFatura||c.faturaSent},c.$on("liftPause",function(){return $(".qr-code").css({opacity:"0.04"}),$(".reload").css("display","")}),c.$on("liftStart",function(){return $(".qr-code").css("opacity",""),$(".reload").css({display:"none"}),c.showQR(window.sessionStorage.sessionID)}),c.showRecover=function(){$(f).addClass("recover"),amplitude.logEvent("button__clicked",{entity_name:"forgot_password",current_screen:"Login",owner:"fraud-security",flow:"reset-password"}),c.hideRecover=!1},c.showQR=function(a){var b;b=document.querySelector(".qr-code"),new QRCode(b,{text:a,width:300,height:300}),b.removeAttribute("title"),$(f).addClass("qr-scan"),c.hideQR=!1,$(".nu-box").css({"min-width":"65rem"}),$(".logout-btn").css({opacity:"1"})},c.emergencyAccess=function(){c.hideQR=!0,c.hideEmergencyAccess=!1,$(f).addClass("emergency-access"),$(".block-card").addClass("cardBlocked"),$(".boleto").addClass("unavailable"),d.emergency.account.then(function(a){var b;return b="blocked"===a.card.status,b||$(".block-card").removeClass("cardBlocked"),c.cardBlocked=b}),d.emergency.bill.then(function(a){if(c.noFatura="closed"!==a.status,!c.noFatura)return $(".boleto").removeClass("unavailable")})},c.reloadQR=function(){var b;for(d.setSessionUUID(),b=document.querySelector(".qr-code");b.firstChild;)b.removeChild(b.firstChild);return new QRCode(b,{text:window.sessionStorage.sessionID,width:300,height:300}),b.removeAttribute("title"),$(".qr-code").css("opacity",""),$(".reload").css({display:"none"}),a.$broadcast("liftResume")},c.boleto=function(){return d.emergency.bill.then(function(a){return c.boletoModal=b.open({templateUrl:"emergency-boleto.template.html",controller:"boletoModal",windowClass:"emergency-boleto",resolve:{bill:function(){return a}}})})},c.blockCard=function(){if($(".block-card").blur(),confirm("Tem certeza que quer bloquear seu cartão? Você poderá desbloqueá-lo entrando em contato com a gente."))return $(".block-card").addClass("loading"),d.emergencyBlockCard().then(function(){$(".block-card").addClass("cardBlocked"),$(".block-card").removeClass("loading"),$(".block-card").removeClass("error"),c.cardBlocked=!0,d.emergency.account.then(function(a){return a.card.status="blocked"})}).catch(function(a){$(".block-card").addClass("error"),$(".block-card").removeClass("loading")})},c.logoutAll=function(){$(".logout-all-btn").blur(),confirm("Isso fará com que todos os dispositivos logados com essa conta se desloguem. Tem certeza que quer revogar o acesso?")&&($(".logout-all").addClass("loading"),d.logout(a.links.revoke_all,"/login"))},c.logout=function(){d.logout(a.links.revoke_token,"/login")},c.secret=function(){var a;c.easter_egg>=2?(c.easter_egg=0,a=$(".nu-logo-bg"),"none"===a.css("transform")?a.css({transform:"rotate(180deg)"}):a.css("transform","")):c.easter_egg+=1},c.back=function(){c.recoverUser="",$(f).removeClass("recover"),$(f).removeClass("emergency-access"),c.hideEmergencyAccess||(c.hideQR=!1),c.hideRecover=!0,c.hideEmergencyAccess=!0,e(function(){return $(f).removeClass("requested")},100)},c.doRecover=function(){var a,b;$(".recover").addClass("loading"),amplitude.logEvent("flow__loaded",{entity_name:"start_reset_password_flow",current_screen:"ResetPasswordCPF",owner:"fraud-security",flow:"reset-password"}),b=function(){return $(f).addClass("requested"),$(".recover").removeClass("loading"),amplitude.logEvent("flow__loaded",{entity_name:"email_sent_reset_password_flow",current_screen:"ResetPasswordCPF",owner:"fraud-security",flow:"reset-password"})},a=function(){return c.recoverError="Houve um erro, por favor, tente novamente.",$(".recover").removeClass("loading"),amplitude.logEvent("error",{entity_name:"error_init_reset_password_flow",current_screen:"ResetPasswordCPF",owner:"fraud-security",flow:"reset-password"})},d.recoverPassword(d.getLink("login"),d.getLink("request_password_reset"),c.clearUser(c.recoverUser)).then(b,a)},$(f).find("#username").focus(),g.startAt&&(c.startAt=g.startAt),g.startFn&&(c.startFn=g.startFn),g.username&&(c.username=g.username),g.failFn?c.failFn=g.failFn:c.failFn=function(a){return 429===a?(c.errorDisplay.login=c.t("loginlimit"),amplitude.logEvent("Auth: Login",{"Error Type":"Rate Limit Exceeded"})):(c.errorDisplay.login=c.t("loginerror"),amplitude.logEvent("Auth: Login",{"Error Type":"Wrong CPF or Password"})),c.user=c.password="",$("input#user").focus()}}}},a=function(a,b,c,d){var e;return e=function(){return parseInt($("#boleto-amount").val().replace(/[^\d]/g,""),10)},a.bill=d,a.hideAmountWarning=function(){return e()>=300},a.validateInput=function(){return e()<300},a.defaultValue=d.amount/100,a.getBoletoEmail=function(){return $(".modal-boleto-btn").blur(),$(".modal-boleto-btn").addClass("loading"),$(".modal-error-text-hidden").removeClass("modal-error-text"),c.emergencyBill(e()).then(function(){$(".modal-boleto-btn").removeClass("loading"),b.dismiss()}).catch(function(){$(".modal-error-text-hidden").addClass("modal-error-text"),$(".modal-boleto-btn").removeClass("loading")}),!0},a.hideBill=function(){return b.dismiss(),!0},a.clearInput=function(){return $("#boleto-amount").val("0,00")}},b=function(a,b){return{restrict:"E",link:function(c){return a.$on("accountReady",function(){amplitude.setUserId(a.customer.id),amplitude.logEvent("Auth: Login"),amplitude.logEvent("App: Open"),b.url("/transactions")}),a.$on("accountFailed",function(){return c.errorDisplay.login="Ainda não é possível acessar sua NuConta através do nosso aplicativo web.",a.$broadcast("clearLoginForm"),amplitude.logEvent("Auth: Login",{"Error Type":"No Account Associated"})})}}},angular.module("conta").directive("login",["$rootScope","$modal","i18n","auth","$timeout",c]).directive("checkStatus",["$rootScope","$location",b]).controller("boletoModal",["$scope","$modalInstance","auth","bill",a])}.call(this),function(){"use strict";var a;a=function(a,b,c){var d,e;return d=c.code,e=c.s,e?b.confirmAccountRecoveryDory(d,e).then(function(a){return window.location="#/account-recovery/"+a}).catch(function(a){return window.location="#/account-recovery/"+a}):b.confirmAccountRecovery(d).then(function(a){return window.location="#/account-recovery/"+a}).catch(function(a){return window.location="#/account-recovery/"+a})},angular.module("conta").controller("AccountRecoveryCtrl",["$scope","auth","$routeParams",a])}.call(this),function(){"use strict";var a;a=angular.module("conta"),a.directive("resizable",["$window",function(a){return function(b){return b.getWindowHeight=function(){return b.windowHeight=a.innerHeight},b.getWindowWidth=function(){return b.windowWidth=a.innerWidth},b.getWindowHeight(),b.getWindowWidth(),angular.element(a).bind("resize",function(){return b.getWindowHeight(),b.getWindowWidth(),b.$apply()})}}])}.call(this),function(){var a;a=function(a){return{restrict:"A",link:function(a,b,c){return a.$on("updatePageTitle",function(a,c){return $(b).html(c)})}}},angular.module("conta").directive("pageTitle",["$route",a])}.call(this),function(){"use strict";var a;a=angular.module("commonWeb",["ngRoute","ngCookies","ipCookie"])}.call(this),function(){var a,b,c,d,e,f,g,h;a=angular.module("commonWeb"),b=(new Date).getFullYear(),d=function(a){return(a/100).toFixed(2).replace(".",",")},a.filter("in_reais",function(){return function(a){var b,c;return b=Math.abs(a),c=b!==a?"-":"","NaN"!==d(b)?c+"R$"+d(b):""}}),h=function(a,b){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,b)},a.filter("precise_reais",function(){return function(a){var b,c;return b=parseFloat(a),c="R$"+h(Math.abs(b).toFixed(2).replace(".",","),"."),b>=0?c:"("+c+")"}}),a.filter("br_number",function(){return d}),c=function(a){return{year4:a.substring(0,4),year2:a.substring(2,4),month:a.substring(5,7),day:a.substring(8,10),hours:a.substring(11,13),minutes:a.substring(14,16),seconds:a.substring(17,19)}},a.filter("capitalize",function(){return function(a){if(a)return a.substring(0,1).toUpperCase()+a.substring(1);
}}),a.filter("truncate7",function(){return function(a){if(a)return a.substring(0,7)}}),a.filter("pretty_date",function(){return function(a){var b;if(a)return b=c(a),""+b.day+"/"+b.month}}),a.filter("date_time",function(){return function(a){var b;if(a)return b=c(a),""+b.year4+"-"+b.month+"-"+b.day+"T"+b.hours+":"+b.minutes+":"+b.seconds}}),a.filter("full_pretty_date",function(){return function(a){var b;if(a)return b=c(a),""+b.day+"/"+b.month+"/"+b.year4}}),a.filter("pretty_time",function(){return function(a){var b;if(a)return b=c(a),""+b.hours+":"+b.minutes}}),g=function(a){var b,d;return b=c(a),d=parseInt(b.month,10),d-1},f=function(a){var b;return b=g(a),["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"][b]},e=function(a){var b;return b=g(a),["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][b]},a.filter("day",function(){return function(a){return c(a).day}}),a.filter("month",function(){return f}),a.filter("full_month",function(){return e}),a.filter("full_date",function(){return function(a){var b;return b=c(a),b.day+" "+f(a)+" "+b.year4}}),a.filter("day_month",function(){return function(a){var b;return b=c(a),b.day+" "+f(a)}}),a.filter("month_year",function(){return function(a){var b;if(a)return b=c(a),""+b.month+"/"+b.year2}}),a.filter("month_year_except_current",function(){return function(a){var d,e;if(a)return d=c(a),e=f(a),b!==parseInt(d.year4)?""+e+" "+d.year2:""+e}}),a.filter("as_card_number",function(){return function(a){if(a)return a.substring(0,4)+" XXXX XXXX XXXX"}}),a.filter("pretty_cpf",function(){return function(a){if(a)return a.substring(0,3)+"."+a.substring(3,6)+"."+a.substring(6,9)+"-"+a.substring(9,11)}}),a.filter("pretty_cep",function(){return function(a){if(a)return a.substring(0,5)+"-"+a.substring(5,8)}}),a.filter("phone_number",function(){return function(a){var b,c,d,e,f,g;if(a)return f=(""+a).match(/[0-9]+/g).join(""),c=f.length,c<8?a:(b=e=d=null,c>=10&&(b="("+f.substr(0,2)+") ",f=f.substr(2)),g=9===f.length?5:4,e=f.substr(0,g),d=f.substr(g),(b||"")+e+"-"+d)}})}.call(this),function(){"use strict";var a;a=angular.module("commonWeb"),a.factory("$jwt",[function(){return{parse:function(a){return jwt.WebTokenParser.parse(a)},decode:function(a){return JSON.parse(jwt.base64urldecode(a))},now:function(){return(new Date).getTime()/1e3},hasAcl:function(a){var b,c;return c=this.parse(a),b=this.decode(c.payloadSegment),b.acl},validate:function(a,b,c,d){var e;return e=this.decode(a),e.iss===b&&(e.aud===c&&(e.exp>d&&e.sub))},verify:function(a,b){return a}}}])}.call(this),function(){"use strict";var a;a=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;return j=null,i={},o="other.conta",p="yQPeLzoHuJzlMMSAjC-LgNUJdUecx8XO",w="https://www.nubank.com.br",n="-1",m=function(a){return a+n},s=function(a){var c;return c={client_secret:p,client_id:o,grant_type:"client_credentials"},b.post(a,c)},u=function(a,c){var d;return d={qr_code_id:c,type:"login-webapp"},b.post(a,d)},J=function(a,b,c,d){var e;return e=f.verify(f.parse(a),b),f.validate(e.payloadSegment,c,d,f.now())},y=function(a){return h.mapValues(a._links,function(a,b){return a.href})},x=function(){return i.tryLift(i.getLink("lift"),c.sessionStorage.sessionID).then(function(a){var b;G(a.access_token),b=J(a.access_token,p,w,o),E(y(a)),H(b),e.$broadcast("authenticated")}).catch(function(a){e.liftAttempt>30?e.$broadcast("liftPause"):(setTimeout(function(){return e.$broadcast("liftReady")},1e3),e.liftAttempt+=1)})},e.$on("liftResume",function(){return C(),x()}),e.$on("liftReady",function(){return x()}),e.$on("liftStart",function(){return x(),i.emergency={},i.emergency.account=z(),i.emergency.bill=A()}),z=function(){var c;return c=a.defer(),b.get(i.getLink("account_emergency")).error(function(a){c.reject(a)}).success(function(a){c.resolve(a)}),c.promise},A=function(){var c;return c=a.defer(),b.get(i.getLink("bill_emergency")).error(function(a){c.reject(a)}).success(function(a){c.resolve(a.bill)}),c.promise},C=function(){return e.liftAttempt=0},v=function(a,c){var d;return d={grant_type:"password",login:a,password:c,client_id:o,client_secret:p},b.post(i.getLink("login"),d).error(function(){return B()}).success(function(b){var c;return c=b.access_token,a=J(c,p,w,o),a?(i.setSessionUUID(),C(),E(y(b)),H(a),G(c),l(),F(a)):r("Invalid Token")})},F=function(a){return c.sessionStorage.user=a,g("user",a,{secure:!0,domain:".nubank.com.br"})},E=function(a){$.extend(e.links,a)},H=function(a){return c.sessionStorage.user=a,c.sessionStorage[m(a)]=JSON.stringify(e.links)},l=function(){var a;return a=c.sessionStorage.userToken,a&&f.hasAcl(a)?e.$broadcast("liftStart"):e.$broadcast("authenticated")},G=function(a){c.sessionStorage.userToken=a,g("userToken",a,{secure:!0,domain:".nubank.com.br"}),i.setAuthHeader(a)},B=function(){return delete c.sessionStorage.user,delete c.sessionStorage.userToken,delete c.sessionStorage.sessionID,g.remove("user",{domain:".nubank.com.br"}),g.remove("userToken",{domain:".nubank.com.br"}),g.remove("customerId",{domain:".nubank.com.br"}),delete b.defaults.headers.common.Authorization},r=function(a,b){return B(),j.reject(b)},D=function(c){var d;return d=a.defer(),b.post(c,{}).error(function(){B(),d.reject()}).success(function(){B(),d.resolve()}),d.promise},k=function(){return b.get(i.getLink("auth_discovery")).success(function(a){E(a)})},q=function(){return b.get(i.getLink("discovery")).success(function(a){E(a)})},t=function(a){return b.get(i.getLink("hypermedia").replace(":id",a)).success(function(a){E(y(a)),l()})},I=function(){var a,b;return b=function(){var b;return a&&a.getRandomValues?(b=new Uint8Array(1),a.getRandomValues(b),(b[0]%16).toString(16)):(16*Math.random()|0).toString(16)},a=window.crypto||window.msCrypto,"xxxxxxxx-xxxx-4xxx-8xxx-xxxxxxxxxxxx".replace(/x/g,b)},i={getLink:function(a){return e.links[a]},setSessionUUID:function(){return c.sessionStorage.sessionID=I()},user:function(){return c.sessionStorage.user||g("user")},enforce:function(a,b,e){var h;return h=c.sessionStorage.userToken||g("userToken"),h&&!f.hasAcl(h)?i.setAuthHeader(c.sessionStorage.userToken||g("userToken")):(d.url(e),a.preventDefault())},tryLift:function(b,d){var e;return e=a.defer(),u(this.getLink("lift"),c.sessionStorage.sessionID).success(function(a){e.resolve(a)}).error(function(a,b){e.reject(b)}),e.promise},login:function(a,b){return v(a,b)},logout:function(a,b){return D(a).finally(function(){return d.path()===b?window.location.reload():d.url(b)})},setAuthHeader:function(a){return b.defaults.headers.common.Authorization="Bearer "+a},getAuthToken:function(b){var c;return c=a.defer(),s(b).error(function(){return c.reject("Failed to retrieve client token")}).success(function(a){c.resolve(a)}),c.promise},restoreOrFetchLinks:function(){var a,b,d;return d=window.sessionStorage.user,a=window.sessionStorage[m(d)],b=c.sessionStorage.userToken||g("userToken"),a&&b&&!f.hasAcl(b)?(i.setAuthHeader(b),E(JSON.parse(a)),l()):(q(),k())},emergencyBill:function(c){var d;return d=a.defer(),this.emergency.bill.then(function(a){var e;return e=y(a),b.post(e.boleto_email,{amount:c}).error(function(a){d.reject(a)}).success(function(){d.resolve()})}),d.promise},emergencyBlockCard:function(){var c;return c=a.defer(),this.emergency.account.then(function(a){var d;return d=y(a.card),b.put(d.block,{}).error(function(a,b){c.reject(b)}).success(function(){c.resolve()})}),c.promise},impersonate:function(){i.setAuthHeader(g("userToken")),t(g("customerId"))},recoverPassword:function(a,c,d){return i.getAuthToken(a).then(function(a){return i.setAuthHeader(a.access_token),b({method:"POST",url:c,headers:{"X-Correlation-Id":"WEB-REQUEST-PASSWORD-RECOVER"},data:{login:d}})})},confirmAccountRecovery:function(c){var d,e;return d=a.defer(),e={code:c},b.get(i.getLink("auth_discovery")).success(function(a){return E(a),b.post(i.getLink("account_recovery_confirm"),e).success(function(){return d.resolve("confirmed")}).error(function(a,b){400===b?d.reject("expired"):d.reject("error")})}),d.promise},confirmAccountRecoveryDory:function(c,d){var e,f;return e=a.defer(),f={code:c},b.post(i.getLink("new_account_recovery_confirm").replace(":prototype",d),f).success(function(){return e.resolve("confirmed")}).error(function(a,b){400===b?e.reject("expired"):e.reject("error")}),e.promise}}},angular.module("conta").factory("auth",["$q","$http","$window","$location","$rootScope","$jwt","ipCookie","_",a])}.call(this),function(){"use strict";var a;a=angular.module("commonWeb"),a.factory("Data",[function(){var a;return a=[],{bulkInsert:function(b){return a=a.concat(b)},insert:function(b){return a.push(b)},getById:function(b){return _.findWhere(a,{id:b})},getAll:function(){return Array.prototype.slice.call(a,0)},clearAll:function(){return a=[]}}}])}.call(this),function(){"use strict";angular.module("commonWeb").factory("i18n",["$rootScope","$cookies",function(a,b){var c,d;return c=b.lang||"pt",d={welcometo:{pt:"bem-vindo a",en:"welcome to",doc:""},username:{pt:"usuário",en:"username",doc:""},password:{pt:"Senha",en:"password",doc:""},remember:{pt:"continuar conectado",en:"remember me",doc:""},signinbutton:{pt:"CONTINUAR",en:"sign in",doc:""},login:{pt:"faça login",en:"log in",doc:""},logout:{pt:"sair",en:"log out",doc:""},loginerror:{pt:"CPF ou senha inválidos.",en:"Invalid CPF or password.",doc:""},loginlimit:{pt:"Você alcançou o limite de tentativas de acesso. Por favor, tente novamente em 5 minutos.",en:"You reached the limit of attempts. Please try again in 5 minutes.",doc:""},accountrequests:{pt:"solicitações de contas",en:"account requests",doc:""},allplural:{pt:"todos",en:"all",doc:""},pending:{pt:"pendente",en:"pending",doc:""},pendingplural:{pt:"pendentes",en:"pending",doc:""},complete:{pt:"completo",en:"complete",doc:""},completeplural:{pt:"completos",en:"complete",doc:""},approved:{pt:"aprovado",en:"approved",doc:""},approvedplural:{pt:"aprovados",en:"approved",doc:""},declined:{pt:"rejeitado",en:"declined",doc:""},declinedplural:{pt:"rejeitados",en:"declined",doc:""},confirmed:{pt:"confirmado",en:"confirmed",doc:""},confirmedplural:{pt:"confirmados",en:"confirmed",doc:""},name:{pt:"nome",en:"name",doc:""},email:{pt:"email",en:"e-mail",doc:""},status:{pt:"situação",en:"status",doc:""},creditlimit:{pt:"limite",en:"credit limit",doc:""},approve:{pt:"aprovar",en:"approve",doc:""},decline:{pt:"rejeitar",en:"decline",doc:""},customers:{pt:"clientes",en:"customers",doc:""},customer:{pt:"cliente",en:"customer",doc:""},phone:{pt:"telefone",en:"phone",doc:""},account:{pt:"conta",en:"account",doc:""},accounts:{pt:"contas",en:"accounts",doc:""},card:{pt:"cartão",en:"card",doc:""},cards:{pt:"cartões",en:"cards",doc:""},transaction:{pt:"transação",en:"transaction",doc:""},transactions:{pt:"transações",en:"transactions",doc:""},payment:{pt:"pagamento",en:"payment",doc:""},payments:{pt:"pagamentos",en:"payments",doc:""},bill:{pt:"fatura",en:"bill",doc:""},bills:{pt:"faturas",en:"bills",doc:""},events:{pt:"eventos",en:"events",doc:""},events_feed_header:{pt:"Últimas transações",en:"Last transactions",doc:""},hello_followed_by_name:{pt:"Oi,",en:"Hi,",doc:"in a header like 'Hello, Fulano!'"},due_date:{pt:"Data de vencimento",en:"Due date",doc:""},due_day:{pt:"dia de vencimento",en:"due day",doc:""},cpf:{pt:"CPF",en:"CPF",doc:""},interest_rate:{pt:"taxa de juros",en:"interest rate",doc:""},personal_info:{pt:"Dados pessoais",en:"Personal data",doc:""},products:{pt:"Produtos",en:"Products",doc:""},address:{pt:"Endereço",en:"Address",doc:""},facebookData:{pt:"Dados do facebook",en:"Facebook data",doc:""},dob:{pt:"data de Nascimento",en:"birthdate",doc:""},gender:{pt:"genêro",en:"gender",doc:""},blocked:{pt:"bloqueado",en:"blocked",doc:"Card status - Blocked"},active:{pt:"ativo",en:"active",doc:"Card status - Active"},revolvers:{pt:"Clientes no Rotativo",en:"Revolvers",doc:""},cohort:{pt:"cohorts",en:"Cohort analysis"},kpi:{pt:"métricas",en:"kpi",doc:""},cashflow:{pt:"fluxo de caixa",en:"cashflow",doc:""},cancel:{pt:"cancelar",en:"cancel",doc:""},expire:{pt:"invalidar",en:"expire",doc:""},cancelled:{pt:"cancelado",en:"cancelled",doc:""},expired:{pt:"inválido",en:"expired",doc:""},edit:{pt:"editar",en:"edit",doc:""},return:{pt:"retornar",en:"return",doc:""},undo:{pt:"desfazer",en:"undo",doc:""},save:{pt:"salvar",en:"save",doc:""},type:{pt:"tipo",en:"type",doc:""},number:{pt:"número",en:"number",doc:""},issuer:{pt:"emissor",en:"issuer",doc:""},uf:{pt:"uf",en:"state",doc:""},issued:{pt:"emissão",en:"issued",doc:""},documents:{pt:"documentos",en:"documents",doc:""},add:{pt:"adicionar",en:"add",doc:""},income:{pt:"renda",en:"income",doc:""},mothers_name:{pt:"nome mãe",en:"mother's name",doc:""},marital_status:{pt:"estado civil",en:"marital status",doc:""},delete:{pt:"deletar",en:"delete",doc:""},prospects:{pt:"lista de espera",en:"prospects",doc:""},reference:{pt:"referência",en:"reference",doc:""},action:{pt:"ação",en:"action",doc:""},invited:{pt:"convidado",en:"invited",doc:""},invitedplural:{pt:"convidados",en:"invited",doc:""},waiting:{pt:"aguardando",en:"waiting",doc:""},waitingplural:{pt:"aguardando",en:"waiting",doc:""},released:{pt:"lançado",en:"released",doc:""},releasedplural:{pt:"lançados",en:"released",doc:""}},{app:function(){var a;return d?(a="",function(b){var e,f;return f=d[b],a=f&&f[c],a||(e=d[b.toLowerCase()],a=e&&e[c]),a}):function(a){return a}},set_lang:function(a){return b.lang=c=a}}}])}.call(this),function(){"use strict";var a;a=angular.module("commonWeb"),a.factory("$poller",["$http","$timeout",function(a,b){var c;return c=function(d,e){return a.get(d).then(function(a){return e(a.data),b(function(){return c(d,e)},1e4)})},{poll:c}}])}.call(this);